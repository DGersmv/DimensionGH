<!DOCTYPE HTML>
<html>
<head>
	<meta charset="UTF-8">
	<title>Dimension Gh</title>
	<style>
		body {
			margin: 0;
			padding: 15px;
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
			background-color: #F5F5F5;
			color: #333333;
			font-size: 13px;
		}
		
		.container {
			background-color: #FFFFFF;
			border: 1px solid #D0D0D0;
			border-radius: 4px;
			padding: 20px;
			box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
		}
		
		.port-section {
			text-align: center;
		}
		
		.port-label {
			font-size: 12px;
			color: #666666;
			margin-bottom: 8px;
		}
		
		.port-value {
			font-size: 24px;
			font-weight: bold;
			color: #0066CC;
			margin: 10px 0;
			font-family: "Courier New", monospace;
		}
		
		.port-unavailable {
			color: #999999;
			font-size: 14px;
		}
		
		.refresh-button {
			background-color: #E0E0E0;
			border: 1px solid #C0C0C0;
			border-radius: 3px;
			padding: 8px 16px;
			font-size: 12px;
			color: #333333;
			cursor: pointer;
			margin-top: 10px;
			transition: background-color 0.2s;
		}
		
		.refresh-button:hover {
			background-color: #D0D0D0;
		}
		
		.refresh-button:active {
			background-color: #C0C0C0;
		}
	</style>
	<script type="text/javascript">
		function UpdateHttpPort () {
			var portElement = document.getElementById ('httpPort');
			if (!portElement) return;
			
			// Clear previous value
			portElement.innerHTML = '';
			
			ACAPI.GetHttpPort ().then (function (port) {
				if (port > 0) {
					portElement.innerHTML = port;
					portElement.className = 'port-value';
				} else {
					portElement.innerHTML = 'Not available';
					portElement.className = 'port-value port-unavailable';
				}
			});
		}
	</script>
</head>
<body>
	<div class="container">
		<div class="port-section">
			<div class="port-label">HTTP Port for Grasshopper</div>
			<div id="httpPort" class="port-value"></div>
			<button class="refresh-button" onclick="UpdateHttpPort ()">Refresh</button>
		</div>
	</div>
	<script type="text/javascript">
		// Update port when page loads
		UpdateHttpPort ();
	</script>
</body>
</html>
